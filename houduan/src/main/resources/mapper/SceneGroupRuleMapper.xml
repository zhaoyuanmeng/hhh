<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xaxc.teqin.mapper.SceneGroupRuleMapper">

    <!-- 根据场景ID查询分组规则 -->
    <select id="selectBySceneId" resultType="com.xaxc.teqin.entity.SceneGroupRule">
        SELECT id, group_name, start_distance, end_distance
        FROM scene_group_rule
        WHERE scene_id = #{sceneId}
          AND plan_node = '警力部署'
          AND delete_flag = 0
        ORDER BY start_distance ASC
    </select>

    <!-- 批量删除场景下的分组规则（逻辑删除） -->
    <update id="deleteBySceneId">
        UPDATE scene_group_rule
        SET delete_flag = 1,
            update_time = NOW()
        WHERE scene_id = #{sceneId}
          AND plan_node = '警力部署'
    </update>
</mapper>